steps:
  #First Clone from github Repository
  - name: 'gcr.io/cloud-builders/git'
    id: 'Clone the project from git hub'
    entrypoint: 'git'
    args: ['clone','https://github.com/Ravindra-87/Try-FirsT-Project.git']

  #Maven Build
  - name: 'gcr.io/cloud-builders/mvn'
    id: 'Build the maven artifact'
    args:
      - 'clean'
      - 'install'
      - '-DskipTests'
    dir: '.'  # Assuming the pom.xml file is in the root of your repo

    #Build the image
  - name: 'gcr.io/cloud-builders/docker'
    id: 'Build the docker image'
    args: ['build','-t','asia-east1-docker.pkg.dev/try-first-project-456718/try-first-project-gar-rep/try-first-project:latest','.']

  #Push the image
  - name: 'gcr.io/cloud-builders/docker'
    id: 'Push the docker image'
    args: ['push','asia-east1-docker.pkg.dev/try-first-project-456718/try-first-project-gar-rep/try-first-project:latest']

    # deploy container image to GKE
  - name: "gcr.io/cloud-builders/gke-deploy"
    args:
      - run
      - --filename=kubernetes/Deployment.yaml
      - --location=us-central1
      - --cluster=dev-cluster

options:
  logging: CLOUD_LOGGING_ONLY